# 注册登录与个人中心

## 说明

APP接口的访问会经过网关转发到各个服务，此处应该是配置文件中配置项

1. 开发网关：`http://localhost:7000/apis/auth-api/`

2. 测试网关：`http://ip地址/apis/auth-api/`

3. 正式网关：`http(s)://域名/apis/auth-api/`

> 参数说明

全局采用`POST`请求，`code`为`0`表示请求成功，其他为错误，消息在`msg`中

> 通用返回成功/失败

```bash
{
	"code":0,
	"msg":"ok"
}

{
	"code":500,
	"msg":"手机号必须填写！"
}
```

## 注册与登录

### ✔获取验证码

**注意**：90秒内不可重复提交获取验证码的请求

**URL**：`app/captcha/{type}/{phone}`

**示例**：

```bash
POST - app/captcha/login/13011111111

# type目前可选，其他选项会报错【必须】
# 1. L1   登录
# 2. R1   注册
# 3. R2   重新绑定
```

**返回**：通用

### ✔注册用户

**URL**：`/app/user/register/phone`

**示例**：

```bash
POST - /app/user/register/phone
{
	"account":"手机号【必填】",
	"password":"验证码【必填】",
	"phone_type":"手机类型安卓还是IOS【必填】",
	"phone_version":"手机操作系统版本【必填】"
}
```

**返回**：通用

### ✔用户登录

**URL**：`/app/user/login/phone`

**示例**：

```bash
POST - /app/user/login/phone
{
	"account":"手机号【必填】",
	"password":"验证码【必填】",
	"phone_type":"手机类型安卓还是IOS【必填】",
	"phone_version":"手机操作系统版本【必填】",
	"login_ip":"登录ip【必填】",
}
```

**返回**：

```bash
{
	"code":0,
	"msg":"ok",
	"data":{
		"id":"用户标识",
		"token":"token"
	}
}
```

## 个人中心

### ✔首页信息展示

返回用户信息和订单信息

**URL**：`/app/user/personal_center/{uid}`

**示例**：

```bash
POST - /app/user/personal_center/{uid}
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
```

**返回**：

```bash
{
	"code":0,
	"msg":"ok",
	"data":{
		"id":"用户标识",
		"user_name":"用户名称",
		"user_phone":"用户手机号",
		"real_status":"实名状态1认证/0未认证",
		"user_sale":{
			"need_to_pay":"待付款",
			"need_to_be_served":"待维修",
			"need_to_comment":"待评论",
			"after_sale_count":"售后"
		}
	}
}
```

## 信息维护

### ✔获取个人信息

**URL**：`app/user/personal_info/{uid}`

**示例**：

```bash
POST - app/user/personal_info/用户标识
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
```

**返回**：

```bash
{
	"code":0,
	"msg":"ok",
	"data":{
		"id":"用户标识",
		"user_name":"用户名称",
		"user_phone":"用户手机号",
		"avatar":"头像地址，需要添加ip/地址，如http://xxx/头像地址",
		"gender":"性别1男/2女/3保密",
		"real_name":"真实姓名"
	}
}
```

### 个人资料修改

**说明**：头像无法修改，暂不支持修改

#### ✔修改用户名

**URL**：`/app/user/modify/name`

**示例**：

```bash
POST - /app/user/modify/name
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
{
	"uid":"用户标识【必填】",
	"user_name":"修改后的名称【必填】"
}
```

**返回**：通用

#### ✔修改性别

**URL**：`/app/user/modify/gender`

**示例**：

```bash
POST - /app/user/modify/gender
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
{
	"uid":"用户标识【必填】",
	"sex":"性别1男/2女/3保密【必填】"
}
```

**返回**：通用

#### ✔修改手机号

**URL**：`/app/user/modify/phone`

**示例**：

```bash
POST - /app/user/modify/phone
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
{
	"uid":"用户标识【必填】",
	"new_phone":"新手机号【必填】",
	"old_phone":"旧手机号【必填】",
	"password":"R2类型验证码【必填】",
	"phone_type":"手机类型安卓还是IOS【必填】",
	"phone_version":"手机操作系统版本【必填】"
}
```

**返回**：通用

#### ✔修改头像

**注意**：查看04上传接口

**URL**：`/app/user/modify/avatar`

**示例**：

```bash
POST - /app/user/modify/avatar
HEADER x-access-token:token【必填】
HEADER x-user-id:user_id【必填】
{
	"uid":"用户标识",
	"avatar":"头像地址，需要先上传，上传后会返回，按照正常控制大小"
}
```

**返回**：通用

**URL**：`/app/user/modify/avatar`

**示例**：
